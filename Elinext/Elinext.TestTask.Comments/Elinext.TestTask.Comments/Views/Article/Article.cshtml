@using Elinext.TestTask.Comments.ViewModels
@model PageModel;
	<script src="~/lib/jquery/dist/jquery.js"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			$(document).on("click", "#add_comment", function () {
				let form = $("form[name='form']");
				form.css("display", "block");
				$("#add_comment").replaceWith(form);
			});
			$(document).on("click", "input[name='send']", function () {
				let comment = $("textarea[name='comment1']").val();
				$("<p>" + comment + "<p/>".appendTo("comments"));
			});
		});
	</script>
	<article>
		<form method="get" asp-controller="article" asp-action="article">
			<span>@ViewBag.PageModel.article.Theme</span>
			<div>@ViewBag.PageModel.article.ArticleContent</div>
		</form>
		<form method="post" asp-controller="article" asp-action="article">
			<table>
				<tr>
					<td>Username</td>
					<td>@Html.EditorFor(model => model.comment.UserName)</td>
				</tr>
				<tr>
					<td>Write comment</td>
					<td>@Html.EditorFor(model => model.comment.CommentContent)</td>
				</tr>
				<tr>
					<td><input type="submit" value="Send" /> </td>
					<td></td>
				</tr>
			</table>
		</form>

		@foreach (var comment in @ViewBag.PageModel.comments)
		{
			<form method="get" asp-controller="article" asp-action="article">
				<div class="comments-wrapper">
					<ul class="comments-list">
						<li itemprop="comment" itemscope class="comment" id="comment-1">
							<div class="comment-content">
								<div class="comment-head">
									<div class="comment-author">
										<span itemprop="author" itemscope>@comment.UserName</span>
									</div>
									<div itemprop="dateCreated" class="comment-createdon">
										@comment.Date
									</div>
								</div>
							</div>
							<div itemprop="text" class="comment-text">
								<span>@comment.CommentContent</span>
							</div>
							<input type="submit" onclick="return false" value="Reply" id="add_comment" href="#">
						</li>
					</ul>
				</div>
			</form>
		}
			<form name="form" id="form" action="#" method="post" style="display:none" onsubmit="return false">
				<label for="textarea"><textarea id="textarea" name="comment1" cols="30" rows="10"></textarea></label>
				<input type="submit" name="send" value="Add Comment" id="done">
			</form>
	</article>
